_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{O2ls:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g})),n.d(t,"SignInUpContainer",(function(){return x}));var r=n("nKUr"),c=(n("g4pe"),n("q1tI")),i=n("20a2"),s=n("d5us"),o=n("Vvt1"),a=n.n(o),l=n("vRNQ"),u=n.n(l),j=n("7KBc"),d=n.n(j),b=a()((function(){return n.e(8).then(n.bind(null,"7vrA"))}),{ssr:!1,loadableGenerated:{webpack:function(){return["7vrA"]},modules:["react-bootstrap/Container"]}}),h=a()((function(){return n.e(9).then(n.bind(null,"3Z9Z"))}),{ssr:!1,loadableGenerated:{webpack:function(){return["3Z9Z"]},modules:["react-bootstrap/Row"]}}),f=a()((function(){return n.e(0).then(n.bind(null,"JI6e"))}),{ssr:!1,loadableGenerated:{webpack:function(){return["JI6e"]},modules:["react-bootstrap/Col"]}}),p=a()((function(){return n.e(0).then(n.bind(null,"cWnB"))}),{ssr:!1,loadableGenerated:{webpack:function(){return["cWnB"]},modules:["react-bootstrap/Button"]}});function O(){var e=Object(i.useRouter)(),t=Object(c.useState)({user:{},loggedIn:!1}),n=(t[0],t[1]);return Object(r.jsxs)(f,{className:"col-12 col-md-8 p-4 bg-light border-right rounded-left",children:[Object(r.jsx)("h2",{children:"Create your Account"}),Object(r.jsxs)("h3",{children:["Love Trader Joe's? Start favoriting recipes and populate your TJ's grocery list! ",Object(r.jsx)("i",{children:"Free forever!"})]}),Object(r.jsx)("form",{onSubmit:function(t){t.preventDefault();var r=new FormData(t.target);fetch("/api/users",{method:"POST",body:r}).then((function(t){alert("You created an account! Build your favorite recipes to easily view your grocery list!"),t.json().then((function(t){console.log(JSON.stringify(t[0].user)),console.log(t[0].user),localStorage.setItem("user",JSON.stringify(t[0].user)),localStorage.setItem("loggedIn",!0),n({loggedIn:!0,user:t[0].user}),e.push("/recipes")}))}))},children:Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsxs)("td",{children:[Object(r.jsx)("label",{htmlFor:"fname",children:"First Name:"})," ",Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"text",name:"fname",id:"fname",placeholder:"Joe",required:!0,minlength:"2",maxlength:"40",autoFocus:!0})]}),Object(r.jsxs)("td",{children:[Object(r.jsx)("label",{htmlFor:"lname",children:"Last Name:"})," ",Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"text",name:"lname",id:"lname",placeholder:"Coulombe",minlength:"2",maxlength:"40",required:!0})]})]}),Object(r.jsxs)("tr",{children:[Object(r.jsxs)("td",{children:[Object(r.jsx)("label",{htmlFor:"phone",children:"10-digit Phone Number:"})," ",Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"tel",name:"phone",id:"phone",placeholder:"4158631292",pattern:"[0-9]{10}",maxLength:"10",required:!0})]}),Object(r.jsxs)("td",{children:[Object(r.jsx)("label",{htmlFor:"fname",children:"Password:"}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Password",required:!0})]})]}),Object(r.jsx)("tr",{children:Object(r.jsx)("td",{children:Object(r.jsx)(p,{type:"submit",className:u.a["submit-button"],children:"Create"})})})]})})})]})}function m(){var e=Object(i.useRouter)(),t=Object(c.useState)({user:{},loggedIn:!1}),n=(t[0],t[1]);return Object(r.jsxs)(f,{className:"col-12 col-md-4 p-4 bg-light rounded-right",children:[Object(r.jsx)("h2",{children:"Log In"}),Object(r.jsx)("h3",{children:"See your recipes and grocery list!"}),Object(r.jsxs)("form",{onSubmit:function(t){t.preventDefault();var r=new FormData(t.target);fetch("/api/userlogin",{method:"POST",body:r}).then((function(t){console.log(t),200===t.status?t.json().then((function(t){localStorage.setItem("user",JSON.stringify(t[0].user)),localStorage.setItem("loggedIn",!0),n({loggedIn:!0,user:t[0].user}),alert("Check out your favorite recipes ".concat(t[0].user.fname,"!")),e.push("/recipes")})):alert("Login Failed. Phone number and/or password is incorrect.")}))},children:[Object(r.jsxs)("p",{children:[Object(r.jsx)("label",{htmlFor:"phonein",children:"Phone Number:"})," ",Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"tel",name:"phonein",id:"phonein",placeholder:"4158631292",maxLength:"10"})]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("label",{htmlFor:"passwordin",children:"Password:"})," ",Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"password",name:"passwordin",id:"passwordin",placeholder:"Your password"})]}),Object(r.jsx)("p",{children:Object(r.jsx)(p,{type:"submit",children:"Log In"})})]})]})}function x(){return Object(r.jsx)("section",{className:u.a["rachel-tile"],children:Object(r.jsx)(b,{className:"my-4 py-4 h-75 w-75",children:Object(r.jsxs)(h,{className:"w-100 h-75 pt-5 rounded",children:[Object(r.jsx)(O,{}),Object(r.jsx)(m,{})]})})})}function g(e){return Object(r.jsxs)("div",{id:"page-container",children:[Object(r.jsx)(s.b,{}),Object(r.jsx)(s.c,{}),Object(r.jsx)(d.a,{bottom:!0,children:Object(r.jsx)(x,{})}),Object(r.jsx)(s.a,{})]})}},VJY8:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var r=n("nKUr"),c=n("d5us"),i=n("O2ls");function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=n("vRNQ"),l=n.n(a),u=n("q1tI"),j=n("VtrM"),d=n("20a2"),b=n("7KBc"),h=n.n(b),f=n("IP2g"),p=n("wHSu");function O(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,c=function(){};return{s:c,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=Object(r.jsx)(f.a,{icon:p.l}),g=Object(r.jsx)(f.a,{icon:p.h}),y=Object(r.jsx)(f.a,{icon:p.g}),v=Object(r.jsx)(f.a,{icon:p.m});function w(e){var t=e.userRecipesData.map((function(e){return e.title})),n=Object(u.useState)([]),c=n[0],i=n[1],s=function(e){var t=e.target.value;i((function(e){return e.includes(t)?e.filter((function(e){return e!==t})):[t].concat(o(e))}))},a=(Object(d.useRouter)(),Object(u.useState)({user:{},loggedIn:!1})),j=(a[0],a[1],Object(u.useState)(null)),b=j[0],h=j[1];Object(u.useEffect)((function(){var e=localStorage.getItem("user");e&&h(JSON.parse(e))}),[]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{id:l.a.navbar,children:Object(r.jsxs)("center",{children:[Object(r.jsxs)("h3",{children:[x," My Grocery List"]}),Object(r.jsx)("p",{className:l.a.text_small,children:" Choose from your favorite recipes to generate your personalized grocery list!"}),t.map((function(e){return Object(r.jsxs)("button",{value:e,onClick:s,className:l.a["add-remove-grocery-button"],children:[c.includes(e)?y:g," ",e]},e)}))]})}),Object(r.jsxs)("div",{className:l.a["flex-container-myrecipespage"],children:[Object(r.jsx)("table",{children:Object(r.jsx)("tbody",{children:c.map((function(e,t){return Object(r.jsx)("tr",{children:Object(r.jsx)("td",{children:e})})}))})}),Object(r.jsx)("form",{onSubmit:function(e){e.preventDefault();"".concat(b.phone),"".concat(b.fname),"".concat(c);confirm("".concat(b.fname,", Do you want to text this grocery list to ").concat(b.phone,"?"))&&fetch("/api/sms",{method:"POST",body:JSON.stringify({user_phone:"+1"+"".concat(b.phone),user_fname:"".concat(b.fname),user_recipes:"".concat(c)}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){console.log(e)})).catch((function(e){console.warn("Something went wrong.",e)}))},children:Object(r.jsxs)("button",{type:"submit",children:[v," Text Me My Grocery List"]})}),Object(r.jsx)("div",{className:l.a["my-ingredient-flex"],children:Object(r.jsx)(S,{userRecipesSelected:e.userRecipesData.filter((function(e){return c.includes(e.title)}))})})]})]})}function S(e){var t,n=[],c=O(e.userRecipesSelected);try{for(c.s();!(t=c.n()).done;){var i=t.value;n.push(Object(r.jsx)(N,{recipe_id:i.recipe_id,title:i.title,directions:i.directions,ingredients:i.ingredients,img:i.img,tags:i.tags}))}}catch(s){c.e(s)}finally{c.f()}return Object(r.jsx)(r.Fragment,{children:n})}function N(e){var t,n;return function(){var n=Object(j.a)("/api/".concat(e.recipe_id,"/ingredients"),(function(e){return fetch(e).then((function(e){return e.json()}))})),c=n.data;n.error||c&&(t=c.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{className:l.a["table-wide"],children:e.abridged_ingredient}),Object(r.jsx)("td",{className:l.a.text_small,children:e.detailed_ingredient})]})})))}(),function(){var t=Object(j.a)("/api/".concat(e.recipe_id,"/tags"),(function(e){return fetch(e).then((function(e){return e.json()}))})),c=t.data;t.error||c&&(n=c.map((function(e){return Object(r.jsxs)("a",{href:"/tags/".concat(e.tag_id),children:["  ",e.name.toUpperCase(),"  "]})})))}(),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{id:l.a["column-left-ingredients"],children:[Object(r.jsx)("p",{className:l.a["recipe-title"],children:Object(r.jsx)("a",{href:"/recipes/".concat(e.recipe_id),children:e.title})}),Object(r.jsx)("p",{className:l.a.text_small,children:Object(r.jsxs)("span",{children:[n," "]})}),Object(r.jsx)("img",{src:e.img,className:l.a["my-recipe-img"],alt:e.title})]}),Object(r.jsx)("div",{id:l.a["column-ingredients"],children:Object(r.jsxs)("table",{id:l.a["ingredients-table"],children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"My Grocery List"}),Object(r.jsx)("th",{children:"Details"})]})}),Object(r.jsx)("tbody",{children:t})]})})]})}function I(e){return Object(r.jsx)("main",{className:l.a["my-container"],children:Object(r.jsx)("div",{children:Object(r.jsx)("center",{children:Object(r.jsx)(w,{userRecipesData:e.userRecipesData})})})})}function _(e){var t=Object(u.useState)(null),n=t[0],s=t[1];Object(u.useEffect)((function(){var e=localStorage.getItem("user");e&&s(JSON.parse(e))}),[]);var o=Object(j.a)("/api/users/".concat(n?n.user_id:2,"/recipes"),(function(e){return fetch(e).then((function(e){return e.json()}))})),a=o.data,l=null;return o.error?l=Object(r.jsx)("div",{children:"failed to load"}):a||(l=Object(r.jsx)("div",{children:"loading..."})),null===n?Object(r.jsxs)("div",{id:"page-container",children:[Object(r.jsx)(c.b,{}),Object(r.jsx)(c.c,{}),Object(r.jsx)(h.a,{bottom:!0,children:Object(r.jsx)(i.SignInUpContainer,{})}),Object(r.jsx)(c.a,{})]}):Object(r.jsxs)("div",{id:"page-container",children:[Object(r.jsx)(c.b,{}),Object(r.jsx)(c.c,{}),l||Object(r.jsx)(I,{userRecipesData:a}),Object(r.jsx)(c.a,{})]})}},p1Dh:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mygrocerylist",function(){return n("VJY8")}])}},[["p1Dh",2,1,5,3,4,6,7]]]);